#!/usr/bin/env bash

# Function to fetch and display subdomain information
fetch_subdomain_info() {
    local domain=$1
    local subdomain=$2
    local full_domain="${subdomain}.${domain}"

    # Fetch DNS record using dig and process with awk
    record=$(dig +short "${full_domain}" | awk 'NR==1{print}')

    if [[ -z "${record}" ]]; then
        echo "The subdomain ${subdomain} does not exist or has no A record."
    else
        echo "The subdomain ${subdomain} is an A record and points to ${record}"
    fi
}

# Main script logic
domain=$1
subdomain=$2

if [[ -z "${domain}" ]]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

if [[ -n "${subdomain}" ]]; then
    fetch_subdomain_info "${domain}" "${subdomain}"
else
    subdomains=("www" "lb-01" "web-01" "web-02")
    for sub in "${subdomains[@]}"; do
        fetch_subdomain_info "${domain}" "${sub}"
    done
fi
